##Connecting MongoDB to Splunk on the Cheap {:.blog-post-title}

January 30, 2016
{:.blog-post-meta}


![Alt text](/static/img/PICTURE.png)


Whether it's a list of your organizations privledged accounts, a collection of assets or a database of IOCs, pulling data into Splunk from external soruces is important aspect for monitoring the security of a network. While a database connector is avaliable at no cost to connect Splunk to a SQL database, it isn't desinged for Mongo, or other No-SQL databases. Hunk is a Splunk developed add-on that does allow Splunk to pull datat in from MongoDB, but it requires the purchasing of additional licensing. 

Splunk supports custom scripts that can enrich data during a search. These scripts are known as external lookups. The concept is similar to a lookup table (a CSV file of infomration queired during a search) with the added power and flexiablity of being a python script.

Creating a external lookup script using pymongo enables Splunk to query a MongoDB without the need for Hunk.  Building the script is fairly straight forward but there are a few tricky items that need to be addressed to make everythign work.

Splunk uses it's own installation of Python, including packages/libraries which causes issues when trying to import pymongo. To resolve this, add `` CODE cODE `` which registers the system's Python packages with Splunk's interpreter.

